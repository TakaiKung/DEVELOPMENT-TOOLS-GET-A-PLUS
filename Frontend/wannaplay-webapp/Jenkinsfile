pipeline {
    agent any
stages {
   stage('Pull code') {
       steps {
           checkout scm
       }
   }
   stage('Download dependency') {
       steps {
           dir('Frontend/wannaplay-webapp') {
               sh 'npm install'
           }
       }
   }
   stage('Run unit test') {
        steps {
              dir('Frontend/wannaplay-webapp') {
                   sh 'npm run test'
              }
        }
   }
   stage('Run Integration test') {
       steps {
           echo 'run component test'
       }
   }
   stage('Build') {
       steps {
           
          dir('Frontend/wannaplay-webapp') {
               sh 'npm run-script build'
           }
       }
   }
    
   stage('Deployment') {
     steps {
        withCredentials([string(credentialsId: 'T09_FRONTEND_PASS', variable: 'T09_PASS')]) {
            sh 'ssh -t -t root@159.65.12.177'
            sh 'yes'
            sh $T09_PASS
            sh 'git clone https://github.com/fluke1352/DEVELOPMENT-TOOLS-GET-A-PLUS.git'

            dir('DEVELOPMENT-TOOLS-GET-A-PLUS') {
                sh 'docker-compose -f docker-compose-deploy-front.yml up -d'
            }
            sh 'rm -r DEVELOPMENT-TOOLS-GET-A-PLUS'

            }     
        }
               
      }
          
   }
    
 }

